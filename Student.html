<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Student Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{font-family:'Poppins',sans-serif;background:#000;color:#e9fbff;margin:0;}
    header{display:flex;align-items:center;gap:12px;padding:12px;background:#111;}
    header .logo{font-family:Orbitron,sans-serif;font-weight:700;font-size:28px;color:#00f0ff;}
    header h1{margin:0;font-size:20px;color:#fff;}
    .container-custom{background:#111;padding:20px;border-radius:12px;margin:20px;}
    input,select,textarea{background:#000;color:#e9fbff;border:1px solid #555;border-radius:8px;padding:8px;}
    button{border-radius:8px;}
    .status-pending{background:#ffd86b;color:#111;padding:5px 10px;border-radius:10px;}
    .status-progress{background:#00f0ff;color:#111;padding:5px 10px;border-radius:10px;}
    .status-resolved{background:#39ff8a;color:#111;padding:5px 10px;border-radius:10px;}
    table{color:#e9fbff;}
    .thumb{width:80px;height:60px;border-radius:6px;object-fit:cover;}
    .filter-btns button{margin-right:6px;margin-bottom:6px;}
    .table-container{max-height:400px;overflow-y:auto;}
  </style>
</head>
<body>

<header>
  <div class="logo">BIET</div>
  <h1>Student Dashboard</h1>
</header>

<div class="container container-custom">
  <div class="row mb-4">
    <div class="col-md-4">
      <h4>Submit Complaint</h4>
      <form id="complaint-form">
        <div class="mb-2"><label>Name (optional)</label><input type="text" id="name" placeholder="Enter your name" /></div>
        <div class="mb-2"><label>Email (optional)</label><input type="email" id="email" placeholder="Enter your email" /></div>
        <div class="mb-2"><label>Issue Type</label><select id="type" required><option>Wi-Fi</option><option>Infrastructure</option><option>Equipment</option><option>Other</option></select></div>
        <div class="mb-2"><label>Location</label><input type="text" id="location" placeholder="Where is the issue?" /></div>
        <div class="mb-2"><label>Description</label><textarea id="desc" placeholder="Describe the issue..." required></textarea></div>
        <div class="mb-2"><label>Attach Image (optional)</label><input type="file" id="file" accept="image/*"/><img id="thumb" class="thumb" style="display:none;margin-top:6px;" alt="Preview"></div>
        <div class="d-flex gap-2"><button class="btn btn-primary">Submit</button><button type="button" class="btn btn-secondary" id="clear-form">Clear</button></div>
      </form>
    </div>

    <div class="col-md-8">
      <div class="d-flex justify-content-between mb-2">
        <h4>All Complaints</h4>
        <input id="search" placeholder="Search..." class="form-control w-50"/>
      </div>

      <div class="filter-btns mb-2">
        <button class="btn btn-sm btn-light" data-status="All">All</button>
        <button class="btn btn-sm btn-warning" data-status="Pending">Pending</button>
        <button class="btn btn-sm btn-info" data-status="In Progress">In Progress</button>
        <button class="btn btn-sm btn-success" data-status="Resolved">Resolved</button>
      </div>

      <div class="table-container">
        <table class="table table-striped table-hover align-middle">
          <thead class="table-dark">
            <tr><th>Name</th><th>Email</th><th>Issue</th><th>Location</th><th>Description</th><th>Status</th><th>Attach</th><th>Actions</th></tr>
          </thead>
          <tbody id="complaint-table"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
let complaints = JSON.parse(localStorage.getItem('complaints')) || [];
const form=document.getElementById('complaint-form'), tableBody=document.getElementById('complaint-table');
const nameIn=document.getElementById('name'), emailIn=document.getElementById('email'), typeIn=document.getElementById('type');
const descIn=document.getElementById('desc'), fileIn=document.getElementById('file'), thumb=document.getElementById('thumb'), locationIn=document.getElementById('location');
const search=document.getElementById('search'); let filterStatus='All';

fileIn.addEventListener('change',()=>{const f=fileIn.files[0]; if(!f){thumb.style.display='none';return;} const r=new FileReader(); r.onload=()=>{thumb.src=r.result;thumb.style.display='block';}; r.readAsDataURL(f);});

function render(){
  const q=search.value.toLowerCase(); tableBody.innerHTML='';
  complaints.slice().reverse().filter(c=>(filterStatus==='All'||c.status===filterStatus)&&
    (c.name?.toLowerCase().includes(q)||c.type.toLowerCase().includes(q)||c.desc.toLowerCase().includes(q)||c.location?.toLowerCase().includes(q))
  ).forEach(c=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${c.name||'Anonymous'}</td><td>${c.email||'-'}</td><td>${c.type}</td><td>${c.location||'-'}</td><td>${c.desc}</td>
      <td><span class="status-${c.status.toLowerCase().replace(' ','-')}">${c.status}</span></td>
      <td>${c.file?`<img src="${c.file}" class="thumb">`:'-'}</td>
      <td>-</td>`;
    tableBody.appendChild(tr);
  });
  localStorage.setItem('complaints',JSON.stringify(complaints));
}

form.addEventListener('submit',async e=>{e.preventDefault();let fileData=''; if(fileIn.files[0]) fileData=await new Promise(res=>{const r=new FileReader(); r.onload=()=>res(r.result); r.readAsDataURL(fileIn.files[0]);});
complaints.push({id:Date.now().toString(),name:nameIn.value,email:emailIn.value,type:typeIn.value,location:locationIn.value,desc:descIn.value,status:'Pending',file:fileData});
form.reset(); thumb.style.display='none'; render(); alert("Complaint submitted!");});

document.getElementById('clear-form').addEventListener('click',()=>form.reset());
search.addEventListener('input',render);
document.querySelectorAll('.filter-btns button').forEach(btn=>{btn.addEventListener('click',()=>{filterStatus=btn.dataset.status;render();});});
render();
</script>
</body>
</html>
